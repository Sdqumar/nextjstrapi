{"ast":null,"code":"import { appConstants } from \"../constants\";\nimport { saveProductResponse } from \"../data\";\nimport { getProductCode } from \"../getProductCode\";\nexport const initialState = {\n  products: [],\n  errors: [],\n  contentSlots: []\n};\n\nconst appReducer = function () {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n  state.products.map(product => product.productImages.length && console.log(product));\n\n  switch (action.type) {\n    case appConstants.GET_CONTENT_SLOTS_SUCCESS:\n      return { ...state,\n        contentSlots: action.payload\n      };\n\n    case appConstants.UPLOAD_PRODUCT_SUCCESS:\n      return action.payload.reduce((state, _ref) => {\n        let {\n          productCode,\n          productName,\n          productCategory,\n          imageFile,\n          imageFileName,\n          imageUrl,\n          id\n        } = _ref;\n        const shouldUpdate = state.products.some(product => product.productCode === productCode);\n\n        if (shouldUpdate) {\n          return { ...state,\n            products: state.products.map(product => product.productCode === productCode ? { ...product,\n              productImages: product.productImages.concat({\n                imageFile,\n                imageFileName,\n                imageUrl,\n                id\n              })\n            } : product)\n          };\n        }\n\n        return { ...state,\n          products: state.products.concat({\n            productCode,\n            productName,\n            productCategory,\n            productExisting: true,\n            slot: [],\n            productImages: [{\n              imageFile,\n              imageFileName,\n              imageUrl,\n              id\n            }]\n          })\n        };\n      }, state);\n\n    case appConstants.VALIDATE_SUCCESS:\n      return { ...state,\n        errors: [...state.errors, ...action.payload.data.filter((data, idx) => {\n          return action.payload.images.some(image => data.id === image.imageFileName);\n        })]\n      };\n\n    case appConstants.UPDATE_PRODUCT_SUCCESS:\n      return { ...state // products: state.products.map((product) => {\n        //   console.log(\n        //     product\n        //   );\n        // })\n\n      };\n\n    case appConstants.SAVE_PRODUCT_SUCCESS:\n      return saveProductResponse.reduce((state, current) => {\n        const shouldUpdate = state.products.some(product => product.productCode === getProductCode(current.name));\n        if (!shouldUpdate) return state;\n        return { ...state,\n          products: state.products.map(product => product.productCode === getProductCode(current.name) ? { ...product,\n            productCode: current.newProductCode,\n            productName: current.productName ? current.productName : \"\"\n          } : product)\n        };\n      }, state);\n\n    case appConstants.CHANGE_CONTENT_SLOTS:\n      return { ...state,\n        products: state.products.map(product => {\n          var _action$payload$produ;\n\n          const isMatches = product.productCode === ((_action$payload$produ = action.payload.product) === null || _action$payload$produ === void 0 ? void 0 : _action$payload$produ.productCode);\n          const isExist = product.slot.some(data => {\n            var _action$payload$slot;\n\n            return data.id === ((_action$payload$slot = action.payload.slot) === null || _action$payload$slot === void 0 ? void 0 : _action$payload$slot.id);\n          });\n\n          switch (true) {\n            case isMatches && isExist:\n              return { ...product,\n                slot: [...product.slot.filter(data => {\n                  var _action$payload$slot2;\n\n                  return data.id !== ((_action$payload$slot2 = action.payload.slot) === null || _action$payload$slot2 === void 0 ? void 0 : _action$payload$slot2.id);\n                }), action.payload.slot]\n              };\n\n            case isMatches && !isExist:\n              return { ...product,\n                slot: [...product.slot, action.payload.slot]\n              };\n\n            default:\n              return { ...product,\n                slot: []\n              };\n          }\n        })\n      };\n\n    case appConstants.SET_CONTENT_SLOT:\n      return { ...state\n      };\n\n    case appConstants.DELETE_IMAGE_SUCCESS:\n      return { ...state,\n        products: state.products.map(product => {\n          var _product$productImage;\n\n          return { ...product,\n            productImages: ((_product$productImage = product.productImages) !== null && _product$productImage !== void 0 ? _product$productImage : []).filter(_ref2 => {\n              let {\n                id\n              } = _ref2;\n              return !action.payload.includes(id);\n            })\n          };\n        })\n      };\n\n    default:\n      return state;\n  }\n};\n\nexport default appReducer;","map":{"version":3,"sources":["/workspace/nextjstrapi/src/reducers/productReducer.js"],"names":["appConstants","saveProductResponse","getProductCode","initialState","products","errors","contentSlots","appReducer","state","action","map","product","productImages","length","console","log","type","GET_CONTENT_SLOTS_SUCCESS","payload","UPLOAD_PRODUCT_SUCCESS","reduce","productCode","productName","productCategory","imageFile","imageFileName","imageUrl","id","shouldUpdate","some","concat","productExisting","slot","VALIDATE_SUCCESS","data","filter","idx","images","image","UPDATE_PRODUCT_SUCCESS","SAVE_PRODUCT_SUCCESS","current","name","newProductCode","CHANGE_CONTENT_SLOTS","isMatches","isExist","SET_CONTENT_SLOT","DELETE_IMAGE_SUCCESS","includes"],"mappings":"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","sourcesContent":["import { appConstants } from \"../constants\";\r\nimport { saveProductResponse } from \"../data\";\r\nimport { getProductCode } from \"../getProductCode\";\r\n\r\nexport const initialState = {\r\n  products: [],\r\n  errors: [],\r\n  contentSlots: []\r\n};\r\n\r\n\r\nconst appReducer = (state = initialState, action) => {\r\n  state.products.map(product=>product.productImages.length && console.log(product))\r\n  switch (action.type) {\r\n    case appConstants.GET_CONTENT_SLOTS_SUCCESS:\r\n      return {\r\n        ...state,\r\n        contentSlots: action.payload\r\n      };\r\n    case appConstants.UPLOAD_PRODUCT_SUCCESS:\r\n      return action.payload.reduce(\r\n        (\r\n          state,\r\n          {\r\n            productCode,\r\n            productName,\r\n            productCategory,\r\n            imageFile,\r\n            imageFileName,\r\n            imageUrl,\r\n            id\r\n          }\r\n        ) => {\r\n          const shouldUpdate = state.products.some(\r\n            (product) => product.productCode === productCode\r\n          );\r\n\r\n          if (shouldUpdate) {\r\n            return {\r\n              ...state,\r\n              products: state.products.map((product) =>\r\n                product.productCode === productCode\r\n                  ? {\r\n                      ...product,\r\n                      productImages: product.productImages.concat({\r\n                        imageFile,\r\n                        imageFileName,\r\n                        imageUrl,\r\n                        id\r\n                      })\r\n                    }\r\n                  : product\r\n              )\r\n            };\r\n          }\r\n\r\n          return {\r\n            ...state,\r\n            products: state.products.concat({\r\n              productCode,\r\n              productName,\r\n              productCategory,\r\n              productExisting: true,\r\n              slot: [],\r\n              productImages: [\r\n                {\r\n                  imageFile,\r\n                  imageFileName,\r\n                  imageUrl,\r\n                  id\r\n                }\r\n              ]\r\n            })\r\n          };\r\n        },\r\n        state\r\n      );\r\n\r\n    case appConstants.VALIDATE_SUCCESS:\r\n      return {\r\n        ...state,\r\n        errors: [\r\n          ...state.errors,\r\n          ...action.payload.data.filter((data, idx) => {\r\n            return action.payload.images.some(\r\n              (image) => data.id === image.imageFileName\r\n            );\r\n          })\r\n        ]\r\n      };\r\n\r\n    case appConstants.UPDATE_PRODUCT_SUCCESS:\r\n      return {\r\n        ...state,\r\n        // products: state.products.map((product) => {\r\n        //   console.log(\r\n\r\n        //     product\r\n        //   );\r\n        // })\r\n      };\r\n\r\n    case appConstants.SAVE_PRODUCT_SUCCESS:\r\n      return saveProductResponse.reduce((state, current) => {\r\n        const shouldUpdate = state.products.some(\r\n          (product) => product.productCode === getProductCode(current.name)\r\n        );\r\n\r\n        if (!shouldUpdate) return state;\r\n\r\n        return {\r\n          ...state,\r\n          products: state.products.map((product) =>\r\n            product.productCode === getProductCode(current.name)\r\n              ? {\r\n                  ...product,\r\n                  productCode: current.newProductCode,\r\n                  productName: current.productName ? current.productName : \"\"\r\n                }\r\n              : product\r\n          )\r\n        };\r\n      }, state);\r\n\r\n    case appConstants.CHANGE_CONTENT_SLOTS:\r\n      return {\r\n        ...state,\r\n        products: state.products.map((product) => {\r\n          const isMatches =\r\n            product.productCode === action.payload.product?.productCode;\r\n\r\n          const isExist = product.slot.some(\r\n            (data) => data.id === action.payload.slot?.id\r\n          );\r\n\r\n          switch (true) {\r\n            case isMatches && isExist:\r\n              return {\r\n                ...product,\r\n                slot: [\r\n                  ...product.slot.filter(\r\n                    (data) => data.id !== action.payload.slot?.id\r\n                  ),\r\n                  action.payload.slot\r\n                ]\r\n              };\r\n            case isMatches && !isExist:\r\n              return {\r\n                ...product,\r\n                slot: [...product.slot, action.payload.slot]\r\n              };\r\n            default:\r\n              return {\r\n                ...product,\r\n                slot: []\r\n              };\r\n          }\r\n        })\r\n      };\r\n\r\n    case appConstants.SET_CONTENT_SLOT:\r\n      return {\r\n        ...state\r\n      };\r\n\r\n    case appConstants.DELETE_IMAGE_SUCCESS:\r\n      return {\r\n        ...state,\r\n        products: state.products.map((product) => ({\r\n          ...product,\r\n          productImages: (product.productImages ?? []).filter(\r\n            ({ id }) => !action.payload.includes(id)\r\n          )\r\n        }))\r\n      };\r\n\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default appReducer;\r\n"]},"metadata":{},"sourceType":"module"}